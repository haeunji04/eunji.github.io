<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@500&display=swap" rel="stylesheet">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원가입</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="js/jquery-3.5.1.js"></script>
    <style>
        table#enroll{
            /* border: 1px solid; */
            border-spacing:20px;
            width: 500px;
            margin: 0 auto ;
        }
        table#enroll th{
            text-align:right;
            
        }
        table#enroll td{
            text-align: left;
        }

        table#enroll td.btn-wrapper{
            text-align: center;
        }

        span.req{
            color:red;
        }
        .short{
            width:50px;
        }
        #save, #button{
            height: 27px;
            border-radius: 8px;
            background-color: rgb(195,221,231);
            outline: none;
            border: 1px solid rgb(195,221,231);

        }

        </style>

    <!--[if lt IE 9]> 
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
    <div id="wrap">
        <header class="header">
            
            <nav>
                <div class="logo">
                    <a href="index.html"><img src="images/logo6.jpg" width="230px" height="100px" alt=""></a>
                </div>
                <div class="navi">
                <ul>
                    <li>
                        <a href="자기소개.html" id="btn1"> <span> 자기소개 </span></a>
                    </li>
                    <li>
                        <a href="관심사.html" id="btn2"><span> 관심사 </span></a>
                        <ul>
                            <li>
                                <a href="관심사-공포영화.html"><span> 공포영화 </span></a>
                            </li>
                            <li>
                                <a href="관심사-동물.html"><span> 동물 </span></a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="개발자로드맵.html" id="btn3"><span> 개발자로드맵 </span></a>
                    </li>
                </ul>
            </div>
            <div class="login">
                <ul>
                    <li>
                        <a href="로그인.html"><span>로그인</span></a>
                    </li>
                    <li>
                        <a href="회원가입.html"><span>회원가입</span></a>
                    </li>
                </ul>
            </div>
            </nav>

        </header>
        <br><br>
        <article style="line-height: 0;">
            <h1><span>회원가입</span></h1>
            <br>
            <p></p>
            <hr>
            <br>
            <div>
                <form autocomplete="off" action="" onsubmit="return validate();">
                    <table id="enroll">
                        <tr>
                            <th>아이디<span class="req">*</span></th>
                            <td>
                                <input type="text" name="userId" id="userId" placeholder="영문자시작/숫자필수/4~12">
                            </td>
                        </tr>
                        <tr>
                            <th>비밀번호<span class="req">*</span></th>
                            <td>
                                <input type="password" name="pwd" id="pwd" placeholder="숫자/문자/특문포함 8~15">
                            </td>
                        </tr>
                        <tr>
                            <th>비밀번호확인</th>
                            <td>
                                <input type="password" id="pwdCheck">
                            </td>
                        </tr>
                        <tr>
                            <th>이름<span class="req">*</span></th>
                            <td>
                                <input type="text" name="userName" id="userName" placeholder="한글 2글자 이상"> 
                            </td>
                        </tr>
                        <tr>
                            <th>이메일<span class="req">*</span></th>
                            <td>
                                <input type="email" name="email" id="email" >
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2" class="btn-wrapper">
                                <input type="submit" id="save" value="회원가입">&nbsp;
                                <input type="reset" id="button" value="초기화">
                            </td>
                        </tr>
                    </table>
                </form>
            </div>
            ​
        </article>
      
        <footer>
            <div id="copy">
                <p style="font-size: 13px;">Copyright 하은지. All rights reserved.</p>
            </div>
        </footer>
    </div>


    <script>
        
        // $("#save").click(function(){
            
        //     // validate();

        //     $(function(){
        //     let k = $("#userId").val();
        //     let userInfo = {
        //         pwd: $("#pwd").val(),
        //         name: $("#userName").val(),
        //         email: $("#email").val()
        //     };
        //     let jsonStr = JSON.stringify(userInfo);
        //     localStorage.setItem(k, jsonStr);
        //     let returnJsonStr = localStorage.getItem(k);
            
        //     let jsObj = JSON.parse(returnJsonStr);
        //     });
            

        // });

        function validate(){
        var userId = document.getElementById("userId");
        var pwd = document.getElementById("pwd");
        var pwdCheck = document.getElementById("pwdCheck");
        var userName = document.getElementById("userName");
        var email = document.getElementById("email");

        //1.아이디검사
        //첫글자는 반드시 영소문자로 이루어지고, 
        //숫자가 하나이상 포함되어야함.
        //아이디의 길이는 4~12글자사이
        var regExp1 = /^[a-z][a-z\d]{3,11}$/;
        var regExp2 = /[0-9]/;
        if(!regExpTest(regExp1
                      ,userId
                      ,"아이디는 영소문자로 시작하는 4~12글자입니다."))
            return false;
        if(!regExpTest(regExp2
                      ,userId
                      ,"아이디는 숫자를 하나이상 포함하세요."))
            return false;


        //2.비밀번호 확인 검사
        //숫자/문자/특수문자/ 포함 형태의 8~15자리 이내의 암호 정규식 
        //전체길이검사 /^.{8,15}$/
        //숫자하나 반드시 포함 /\d/ 
        //영문자 반드시 포함 /[a-zA-Z]/
        //특수문자 반드시 포함  /[\*!&]/

        else if(!(/\d/.test(pwd.value) 
            && /[a-zA-Z]/.test(pwd.value) 
            && /[\?~!@#$%^&*()_+]/.test(pwd.value))){
            alert("비밀번호는 8~15자리 숫자/문자/특수문자를 포함해야합니다.");
            pwd.value = "";
            return false;
        }
        //비밀번호일치여부 검사
        else if(!(pwd.value === pwdCheck.value)){
            alert("비밀번호가 서로 일치하지 않습니다.");
            pwd.value = "";
            pwdCheck.value = "";
            return false;
        }

        //3.이름검사
        //한글2글자 이상만 허용. [가-힣] 으로 해도되긴 하지만 자음만(ㄱㄴㄷㄹ)있으면 필터링이 안됨
        var regExp3 = /^[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]{2,}$/;
        if(!regExpTest(regExp3,userName,"한글 2글자이상 입력하세요."))
            return false;

        //5.이메일 검사
        // 4글자 이상(\w = [a-zA-Z0-9_], [\w-\.]) @가 나오고
        // 1글자 이상(주소). 글자 가 1~3번 반복됨
        if(!regExpTest(/^[\w]{4,}@[\w]+(\.[\w]+){1,3}$/, email, "이메일 형식에 어긋납니다."))
                return false;

        
        saveUser();
        
            function saveUser(){
            let k = $("#userId").val();
            let userInfo = {
                pwd: $("#pwd").val(),
                name: $("#userName").val(),
                email: $("#email").val()
            };
            let jsonStr = JSON.stringify(userInfo);
            localStorage.setItem(k, jsonStr);
            let returnJsonStr = localStorage.getItem(k);
            
            let jsObj = JSON.parse(returnJsonStr);
            alert('회원가입 되었습니다.', location.href="index.html");
            
        };
            

                


    function regExpTest(regExp, el, msg){
        if(regExp.test(el.value))
            return true;
        //적합한 문자열이 아닌 경우
        alert(msg);
        el.value="";
        el.focus();
        return false;
        }
    }
        </script>


</body>
</html>